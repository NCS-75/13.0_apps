<?xml version="1.0" encoding="UTF-8"?>
<odoo>

    <template id="purchase_quotation_pricing_detail" name="Price">
        <section id="quote">
            <h3 id="details" class="mt32">Pricing</h3>
            <t t-foreach="quotation.order_lines_layouted()" t-as="page">
                <table class="table table-sm" id="po_order_table">
                    <thead class="bg-100">
                        <tr>
                            <th class="text-left">Products</th>
                            <th class="text-right">Quantity</th>
                            <th class="text-right">
                                <span t-if="any([line.taxes_id for line in quotation.order_line])">Taxes</span>
                            </th>
                            <th />
                            <th class="text-right">Unit Price</th>
                            <th class="text-right">Amount</th>
                            <th class="text-right price_tax_included">Total Price</th>
                            <th />
                        </tr>
                    </thead>
                    <tbody>
                        <t t-foreach="page" t-as="layout_category">
                            <t t-if="layout_category_size &gt; 1 or page_size &gt; 1">
                                <tr class="active">
                                    <td colspan="7" style="font-weight: bold; border-bottom: 1px solid black;">
                                        &amp;bull;
                                        <t t-esc="layout_category['name']" />
                                    </td>
                                </tr>
                            </t>
                            <t t-foreach="layout_category['lines']" t-as="line">
                                <tr>
                                    <td>
                                        <span t-field="line.name" />
                                    </td>
                                    <td class="text-right">
                                        <div id="quote_qty">
                                            <span t-field="line.product_qty" />
                                            <span t-field="line.product_uom" />
                                        </div>
                                    </td>
                                    <td>
                                        <div t-foreach="line.taxes_id" t-as="tax">
                                            <t t-esc="tax.name" />
                                        </div>
                                    </td>
                                    <td />
                                    <td class="text-right">
                                        <div t-field="line.price_unit" t-options="{&quot;widget&quot;: &quot;monetary&quot;, &quot;display_currency&quot;: quotation.currency_id}" />
                                    </td>
                                    <td class="text-right">
                                        <span t-field="line.price_subtotal" t-options="{&quot;widget&quot;: &quot;monetary&quot;, &quot;display_currency&quot;: quotation.currency_id}" />
                                    </td>
                                    <td class="text-right">
                                        <span t-field="line.price_total" t-options="{&quot;widget&quot;: &quot;monetary&quot;, &quot;display_currency&quot;: quotation.currency_id}" />
                                    </td>
                                    <td class="text-center">
                                        <a t-attf-href="./update_line/#{ line.id }/?order_id=#{ quotation.id }&amp;unlink=True&amp;token=#{ quotation.access_token }" class="mb8 js_update_line_json d-print-none" t-if="line.option_line_id">
                                            <span class="fa fa-trash-o" />
                                        </a>
                                    </td>
                                </tr>
                            </t>
                            <t t-if="(layout_category_size &gt; 1  or page_size &gt; 1) and layout_category['subtotal']">
                                <tr>
                                    <td />
                                    <td />
                                    <td />
                                    <td />
                                    <td class="text-right" style="padding-bottom: 32px">
                                        <strong>Subtotal:</strong>
                                    </td>
                                    <td class="text-right" style="padding-bottom: 32px">
                                        <t t-set="subtotal" t-value="sum(line.price_subtotal for line in layout_category['lines'])" />
                                        <strong data-id="total_amount_purchase" t-esc="subtotal" t-options="{'widget': 'monetary', 'display_currency': quotation.pricelist_id.currency_id}" />
                                    </td>
                                    <td />
                                </tr>
                            </t>
                        </t>
                        <t t-if="page_index == page_size - 1">
                            <t t-if="any([line.taxes_id for line in quotation.order_line])">
                                <tr>
                                    <td />
                                    <td />
                                    <td />
                                    <td />
                                    <td />
                                    <td class="text-right">
                                        <strong>Subtotal:</strong>
                                    </td>
                                    <td class="text-right">
                                        <strong data-id="total_amount_purchase" t-field="quotation.amount_untaxed" t-options="{&quot;widget&quot;: &quot;monetary&quot;,&quot;display_currency&quot;: quotation.pricelist_id.currency_id}" />
                                    </td>
                                    <td />
                                </tr>
                                <tr>
                                    <td />
                                    <td />
                                    <td />
                                    <td />
                                    <td />
                                    <td class="text-right">Taxes:</td>
                                    <td class="text-right">
                                        <span data-id="total_amount_purchase" t-field="quotation.amount_tax" t-options="{&quot;widget&quot;: &quot;monetary&quot;,&quot;display_currency&quot;: quotation.pricelist_id.currency_id}" />
                                    </td>
                                    <td />
                                </tr>
                            </t>
                            <tr>
                                <td />
                                <td />
                                <td />
                                <td />
                                <td />
                                <td class="text-right">
                                    <strong>Total:</strong>
                                </td>
                                <td class="text-right">
                                    <strong data-id="total_amount_purchase" t-field="quotation.amount_total" t-options="{&quot;widget&quot;: &quot;monetary&quot;,&quot;display_currency&quot;: quotation.pricelist_id.currency_id}" />
                                </td>
                                <td />
                            </tr>
                        </t>
                    </tbody>
                </table>
                <t t-if="page_index &lt; page_size - 1">
                    <p style="page-break-before:always;" />
                </t>
            </t>
        </section>
        <section id="terms" class="container" t-if="quotation.notes">
            <h2 class="card-header">Terms &amp; Conditions</h2>
            <p t-field="quotation.notes" />
        </section>
    </template>

    <template id="change_quantity_purchase" inherit_id="website_purchase_quote.purchase_quotation_pricing_detail" active="False" customize_show="True" name="Change Quantity">
        <xpath expr="//div[@id='quote_qty']" position="replace">
            <div class="input-group oe_website_spinner">
                <span class="input-group-addon d-print-none">
                    <a t-attf-href="./update_line/#{ line.id }/?order_id=#{ quotation.id }&amp;remove=True&amp;token=#{ quotation.access_token }" class="mb8 js_update_line_json">
                        <span class="fa fa-minus" />
                    </a>
                </span>
                <input type="text" class="js_quantity form-control" t-att-data-id="line.id" t-att-value="line.product_uom_qty" />
                <span class="input-group-addon d-print-none">
                    <a t-attf-href="./update_line/#{ line.id }/?order_id=#{ quotation.id }&amp;token=#{ quotation.access_token }" class="mb8 js_update_line_json">
                        <span class="fa fa-plus" />
                    </a>
                </span>
            </div>
        </xpath>
    </template>

    <template id="po_quotation_content_purchase" name="Quotation Content">
         <div class='card'>
            <div id="introduction" class="pb-2 pt-3 card-header bg-white">
                <h2 class="my-0">
                    <t t-if="quotation.state in ('draft','sent','cancel')">Your Quotation</t>
                    <t t-if="quotation.state not in ('draft','sent','cancel')">Your Order</t>
                    <em t-esc="quotation.name" />
                    <small t-field="quotation.state" />
                    <div t-ignore="true" class="pull-right css_editable_mode_hidden d-print-none pb16">
                        <ul class="list-inline">
                            <li class="float-right ml-2">
                                <a t-if="quotation.state not in ('manual')" class="btn btn-info d-print-none" t-att-href="'/web#return_label=Website&amp;model=%s&amp;id=%s&amp;action=%s&amp;view_type=form' % (quotation._name, quotation.id, action)">Edit Quote</a>
                                <a t-if="quotation.state in ('manual')" class=" btn btn-info d-print-none" t-att-href="'/web#return_label=Website&amp;model=%s&amp;id=%s&amp;action=%s&amp;view_type=form' % (quotation._name, quotation.id, action)">Back to Purchase Order</a>
                            </li>
                            <li class="float-right">
                                <a class="btn btn-info d-print-none" target="_blank" t-att-href="'/purchase/%s/%s' % (quotation.id,quotation.access_token)+'?pdf=True'">Print</a>
                            </li>
                            <li>
                                <t t-call="portal.record_pager" />
                            </li>
                        </ul>
                    </div>
                </h2>
            </div>
            <div class="card-body">
                <div id="informations">
                    <div class="row mt32">
                        <div class="col-6">
                            <div class="row">
                                <div class="clearfix"/>
                                <label class="col"><strong>Vendor:</strong></label>
                                <div class="col-8">
                                    <div t-field="quotation.partner_id" />
                                </div>
                            </div>
                            <div class="row">
                                <div class="clearfix"/>
                                <label class="col"><strong>Bill To:</strong></label>
                                <div class="col-8">
                                    <div t-field="quotation.partner_id" t-options="{                           &quot;widget&quot;: &quot;contact&quot;,                           &quot;fields&quot;: [&quot;address&quot;, &quot;name&quot;, &quot;phone&quot;, &quot;email&quot;]                           }" />
                                </div>
                            </div>
                            <div t-if="quotation.dest_address_id.id" class="row">
                                <div class="clearfix"/>
                                <label class="col"><strong>Ship To:</strong></label>
                                <div class="col-8">
                                    <div t-field="quotation.dest_address_id" t-options="{                         &quot;widget&quot;: &quot;contact&quot;,                         &quot;fields&quot;: [&quot;address&quot;, &quot;name&quot;, &quot;phone&quot;]                         }" />
                                </div>
                            </div>
                        </div>
                        <div class="col-6">
                            <div class="row">
                                <div class="clearfix"/>
                                <label class="col"><strong>Your Contact:</strong></label>
                                <div class="col-8">
                                    <div t-field="quotation.create_uid" t-options="{                           &quot;widget&quot;: &quot;contact&quot;,                           &quot;fields&quot;: [&quot;name&quot;, &quot;phone&quot;, &quot;email&quot;]                           }" />
                                </div>
                            </div>
                            <div class="row" t-if="quotation.date_order">
                                <div class="clearfix"/>
                                <label class="col"><strong>Quote Date:</strong></label>
                                <div class="col-8">
                                    <span t-field="quotation.date_order" />
                                </div>
                            </div>
                            <div class="row" t-if="quotation.validity_date">
                                <div class="clearfix" />
                                <label class="col"><strong>Expiration Date:</strong></label>
                                <div class="col-8">
                                    <span t-field="quotation.validity_date" />
                                </div>
                            </div>
                            <div class="row" t-if="quotation.partner_ref">
                                <div class="clearfix" />
                                <label class="col"><strong>Your Reference:</strong></label>
                                <div class="col-8">
                                    <span t-field="quotation.partner_ref" />
                                </div>
                            </div>
                            <div class="row" t-if="quotation.payment_term_id">
                                <div class="clearfix"/>
                                <label class="col"><strong>Payment Terms:</strong></label>
                                <div class="col-8">
                                    <span t-field="quotation.payment_term_id" />
                                </div>
                            </div>
                        </div>
                    </div>
                    <div t-field="quotation.website_description" class="oe_no_empty" />
                    <t t-foreach="quotation.order_line" t-as="line">
                        <a t-att-id="line.id" />
                        <div t-att-class="'oe_no_empty' if line.website_description else 'oe_no_empty d-print-none'" t-field="line.website_description" />
                    </t>
                    <div class="oe_structure" />
                    <t t-call="website_purchase_quote.purchase_quotation_pricing_detail" />
                </div>
            </div>
        </div>
    </template>

   <!--  <template id="payment_confirmation_status_purchase">
        <div t-if="payment_tx_id and payment_tx_id.state == 'done'" class="alert alert-success alert-dismissable">
            <button type="button" class="close" data-dismiss="alert" aria-hidden="true">&amp;times;</button>
            <span t-if="payment_tx_id.acquirer_id.done_msg" t-raw="payment_tx_id.acquirer_id.done_msg" />
            <span t-if="payment_tx_id.acquirer_id.post_msg" t-raw="payment_tx_id.acquirer_id.post_msg" />
        </div>
        <div t-if="payment_tx_id and payment_tx_id.state == 'pending'" class="alert alert-warning alert-dismissable">
            <button type="button" class="close" data-dismiss="alert" aria-hidden="true">&amp;times;</button>
            <span t-if="payment_tx_id.acquirer_id.pending_msg" t-raw="payment_tx_id.acquirer_id.pending_msg" />
            <span t-if="payment_tx_id.acquirer_id.post_msg" t-raw="payment_tx_id.acquirer_id.post_msg" />
        </div>
        <div t-if="payment_tx_id and payment_tx_id.state == 'cancel'" class="alert alert-danger alert-dismissable">
            <button type="button" class="close" data-dismiss="alert" aria-hidden="true">&amp;times;</button>
            <span t-if="payment_tx_id.acquirer_id.cancel_msg" t-raw="payment_tx_id.acquirer_id.cancel_msg" />
        </div>
        <div t-if="payment_tx_id and payment_tx_id.state == 'error'" class="alert alert-danger alert-dismissable">
            <button type="button" class="close" data-dismiss="alert" aria-hidden="true">&amp;times;</button>
            <span t-if="payment_tx_id.acquirer_id.error_msg" t-raw="payment_tx_id.acquirer_id.error_msg" />
        </div>
        <div t-if="payment_tx_id and payment_tx_id.state == 'authorized'" class="alert alert-success alert-dismissable">
            <button type="button" class="close" data-dismiss="alert" aria-hidden="true">&amp;times;</button>
            Your payment has been authorized.
            <span t-if="payment_tx_id.acquirer_id.post_msg" t-raw="payment_tx_id.acquirer_id.post_msg" />
        </div>
    </template>
 -->
</odoo>